## âš™ï¸ Replace Joi â†’ Zod in the Backend Setup

### ğŸ§© Install Zod

```bash
npm install zod
```

---

## ğŸ§  Example Validation (Zod Style)

### âœ… Create Chapter Schema

```js
import { z } from "zod";

export const createChapterSchema = z.object({
  chapterNumber: z.string().min(1, "Chapter number is required"),
  chapterTitle: z.string().min(1, "Chapter title is required"),
  sections: z
    .array(
      z.object({
        subTitle: z.string().optional(),
        description: z.string().optional(),
        imageUrl: z.string().url().optional(),
      })
    )
    .optional(),
});
```

---

### âœ… Middleware for Request Validation

You can make a reusable validator middleware that works with any Zod schema:

```js
// middleware/validateRequest.js
import { ZodError } from "zod";

export const validateRequest = (schema) => (req, res, next) => {
  try {
    schema.parse(req.body);
    next();
  } catch (err) {
    if (err instanceof ZodError) {
      return res.status(400).json({
        success: false,
        message: "Validation failed",
        errors: err.errors.map((e) => ({
          path: e.path.join("."),
          message: e.message,
        })),
      });
    }
    next(err);
  }
};
```

---

### âœ… Usage in Routes

```js
import express from "express";
import { validateRequest } from "../middleware/validateRequest.js";
import { createChapterSchema } from "../validation/chapter.schema.js";
import { createChapter } from "../controllers/chapter.controller.js";

const router = express.Router();

router.post(
  "/courses/:courseId/chapters",
  validateRequest(createChapterSchema),
  createChapter
);

export default router;
```

---

### âœ… Example Zod Schemas for Course + Homework

#### `validation/course.schema.js`

```js
import { z } from "zod";

export const createCourseSchema = z.object({
  name: z.string().min(1, "Course name is required"),
  author: z.string().min(1, "Author is required"),
  sectionCount: z.number().int().nonnegative().optional(),
  description: z.string().optional(),
});
```

#### `validation/homework.schema.js`

```js
import { z } from "zod";

export const createHomeworkSchema = z.object({
  homeworkId: z.number(),
  homeworkTitle: z.string().min(1, "Title is required"),
  description: z.string().optional(),
  help: z.string().optional(),
  exampleCode: z.string().optional(),
  answer: z.string().optional(),
  hints: z.array(z.string()).optional(),
  resources: z
    .array(
      z.object({
        title: z.string(),
        url: z.string().url(),
      })
    )
    .optional(),
});
```

---

### âœ… Optional: Add Type Inference (if you use TypeScript)

If your backend is in TypeScript, Zod can infer types automatically:

```ts
export type CreateChapterInput = z.infer<typeof createChapterSchema>;
```

Then in your controller:

```ts
export const createChapter = async (
  req: Request<{}, {}, CreateChapterInput>,
  res: Response
) => {
  // req.body is now fully typed
};
```

---

## ğŸ§© Updated Folder Structure with Zod

```
src/
â”œâ”€â”€ validation/
â”‚   â”œâ”€â”€ course.schema.js
â”‚   â”œâ”€â”€ chapter.schema.js
â”‚   â””â”€â”€ homework.schema.js
â”œâ”€â”€ middleware/
â”‚   â””â”€â”€ validateRequest.js
```

---

### âœ… TL;DR â€” Why Zod over Joi

| Feature                          | Joi        | Zod                         |
| -------------------------------- | ---------- | --------------------------- |
| TypeScript support               | âŒ limited | âœ… native                   |
| Tree-shaking                     | âŒ         | âœ…                          |
| Works in both backend + frontend | âŒ         | âœ…                          |
| Custom error handling            | âœ…         | âœ…                          |
| Express integration              | âœ…         | âœ… (with custom middleware) |
| DX (developer experience)        | good       | **great** ğŸš€                |
